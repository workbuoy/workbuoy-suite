export async function generate({prompt,context,user_goal}){const bullets=(context||[]).map(c=>`• ${c.title||'Note'}: ${String(c.content||'').slice(0,240)}`);const header=user_goal?`Mål: ${user_goal}. `:'';const body=bullets.length?bullets.join('\n'):'Jeg fant ingen kunnskapsartikler. Prøv å koble en kilde eller legg til dokumenter.';const answer=`${header}${body}\n\nNeste steg: Du kan åpne Portal → Koblinger for å få mer treffsikre svar.`;return { text: answer, tokens_in: prompt.length, tokens_out: answer.length };}