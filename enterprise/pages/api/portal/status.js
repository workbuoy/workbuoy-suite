import path from 'path';import sqlite3 from 'sqlite3';import { resolveTenantId } from '../../../lib/middleware/tenant.js';const DB_PATH=process.env.DB_PATH||path.join(process.cwd(),'db','workbuoy.db');export default function handler(req,res){const tenant_id=resolveTenantId(req);const db=new sqlite3.Database(DB_PATH);const out={tenant_id,connectors:[],plan:null,demo:true};db.get(`SELECT plan,status FROM subscriptions WHERE tenant_id=? ORDER BY id DESC LIMIT 1`,[tenant_id],(e1,s)=>{out.plan=s?.plan||'Solo Pro';db.all(`SELECT provider,status FROM tenant_connectors WHERE tenant_id=?`,[tenant_id],(e2,rows)=>{out.connectors=rows||[];out.demo=!(rows||[]).some(r=>r.status==='connected');res.json(out);});});}